---
import { readFile } from "@directus/sdk";

import { Client } from "@/lib/directus";
import type { DirectusFileStub } from "@/lib/types";

interface Props {
  asset: string | DirectusFileStub;
  alt?: string;
}

const { asset, alt } = Astro.props;
const file =
  typeof asset === "string"
    ? await Client.request(
        readFile(asset, {
          fields: ["id", "width", "height"],
        }),
      )
    : asset;
---

<img
  loading="lazy"
  src={`/assets/${file.id}?width=1800&height=1800&fit=inside`}
  alt={alt}
  width={file?.width}
  draggable="false"
  height={file?.height}
/>
